# ๐ ุฏููู ูุทูุฑ KawnHub ููุฑุดุฏ ุงูุฐูุงุก ุงูุงุตุทูุงุนู

<div dir="rtl" lang="ar">

**ุชุญุฐูุฑ:** ูุฐุง ุงููุดุฑูุน ูุณุชุฎุฏู ุจููุฉ **Next.js 15+** ุงูุญุฏูุซุฉ (**React Server Components**). ุงููุดู ูู ููู ูุฐู ุงูุจููุฉ ูู ุงูุณุจุจ ุงูุฑุฆูุณู ูุฃู ุฃุฎุทุงุก.

---

## 1. ุงูููุณูุฉ ุงูุฃุณุงุณูุฉ (The Core Philosophy)

**ุงูุณุฑุนุฉุ ุงูููุซูููุฉุ ุงูุจุณุงุทุฉ.**

ููุฏ ูููุง ุจุชุฌุฑุจุฉ ููุชุจุงุช ุชุญุฑูุฑ ูุนูุฏุฉ (**TipTap**, **Lexical**, **react-quill**) ููุดูุช ุฌููุนูุง ุจุณุจุจ ูุดุงูู ุงูุชูุงูู ูุน **React 19**.

> **ุงููุงุนุฏุฉ ุงูุฐูุจูุฉ:**  
> ูุง ุชูู ุจุฅุถุงูุฉ ุฃู ููุชุจุฉ ุฎุงุฑุฌูุฉ ูุนูุฏุฉ ุชุชุนุงูู ูุน ุงูู DOM (ูุซู ูุญุฑุฑุงุช ุงููุตูุต) ูุจู ุงูุชุฃูุฏ 100% ูู ุชูุงูููุง ูุน **React 19**.  
> ุงูุญููู ุงูุฃุตููุฉ (Native) ุงูุชู ูุจูููุง ุจุฃููุณูุง ูู ุฏุงุฆููุง ุงูุฎูุงุฑ ุงูุฃูุถู ูุงูุฃูุซุฑ ุงุณุชูุฑุงุฑูุง.

---

## 2. ุงูุจููุฉ ุงูุฃุณุงุณูุฉ (The "Must-Know" Architecture)

ูุฐุง ุงููุดุฑูุน ูุชุจุน ุจุตุฑุงูุฉ ูููุฐุฌ **ูุตู ุงููุงุฌูุงุช (Server/Client)**.

### ุฃ. ููููุงุช ุงูุฎุงุฏู (Server Components)  
ูุซุงู: `/hub/page.js`

- **ุงููุธููุฉ:** ุฌูุจ ุงูุจูุงูุงุช.
- **ุงูููุงู:** ุฃู ููู `page.js` ุฃู `layout.js` **ูุง ูุญุชูู ุนูู `'use client'`** ูู ุฃุนูุงู.
- **ุงูููุฉ:** ูููููุง ุงุณุชูุฑุงุฏ `db` ูู `src/lib/firebase.js` ูุจุงุดุฑุฉ ูุงูุชุญุฏุซ ุฅูู ูุงุนุฏุฉ ุงูุจูุงูุงุช.
- **ุงููุดููุฉ:** ูุง ูููููุง ุงุณุชุฎุฏุงู `useState` ุฃู `onClick` (ุงูุชูุงุนู).

### ุจ. ููููุงุช ุงูุนููู (Client Components)  
ูุซุงู: `HubInterface.js`

- **ุงููุธููุฉ:** ุงูุชูุงุนู ูุงูุนุฑุถ.
- **ุงูููุงู:** ุฃู ููู **ูุญุชูู ุนูู `'use client'`** ูู ุฃุนูุงู.
- **ุงูููุฉ:** ูููููุง ุงุณุชุฎุฏุงู `useState`, `useEffect`, `onClick`.

> **!! ุงููุงุนุฏุฉ ุงูุฃูู (ูุง ุชูุณุฑูุง ุฃุจุฏูุง) !!**  
> **ููููุน ููุนูุง ุจุงุชูุง** ุงุณุชูุฑุงุฏ ุฃู ุดูุก ูู `src/lib/firebase.js` (ูุซู `db` ุฃู `auth`) ุฏุงุฎู ูููู ุนููู.  
>  
> **ููุงุฐุงุ** ูุฃู ูุฐู ุงูููุชุจุงุช ุชุญุชูู ุนูู ููุฏ "ุฎุงุฏู" (Server-side code)ุ ููุญุงููุฉ ุชุดุบูููุง ูู ุงููุชุตูุญ ุณุชุคุฏู ุฅูู **ุงูููุงุฑ ุงูุชุทุจูู** (ูุฐุง ูู ุงูุฎุทุฃ ุงูุฐู ูุงุฌููุงู ูุฑุงุฑูุง).

### ุฌ. ุชุฏูู ุงูุจูุงูุงุช ุงูุตุญูุญ (The Flow)

1. ูููู ุงูุฎุงุฏู (`/hub/page.js`) ูููู ุจุฌูุจ ูู ุงูุจูุงูุงุช ูู **Firebase**.
2. ูููู ุจู **"ุชุณูุณู" (Serialize)** ุงูุจูุงูุงุช (ุชุญููู ูุงุฆูุงุช `Timestamp` ุงููุนูุฏุฉ ุฅูู ูุตูุต ุจุณูุทุฉ).
3. ูููู ุจุชูุฑูุฑ ูุฐู ุงูุจูุงูุงุช ุงูุจุณูุทุฉ ูู `props` ุฅูู ูููู ุงูุนููู:  
   `<HubInterface initialTopics={...} />`
4. ูููู ุงูุนููู ูุณุชูู ุงูู `props` ููุณุชุฎุฏู `useState` ูุฅุฏุงุฑุฉ ุงูุชูุงุนูุงุช (ูุซู ุงูุจุญุซ ูุงูููุชุฑุฉ).

---

## 3. ูุธุงู ุงูุจูููุงุช ุงููุฎุตุต (The Custom Block System)

ูุฐุง ูู **ููุจ ููุญุฉ ุงูุชุญูู**. ูุญู ูุง ูุณุชุฎุฏู ููุชุจุฉ ูุญุฑุฑ ูุตูุต. ููุฏ ูููุง ุจุจูุงุก ูุธุงููุง ุงูุฎุงุต.

- **ุงูููุงู:**  
  `src/app/admin/topics/new/page.js`  
  `src/app/admin/topics/[id]/page.js`

### ููู ูุนููุ

- ุงูุจูุงูุงุช ูุฎุฒูุฉ ูู `topicData.content` ูู **ูุตูููุฉ (Array)**.
- ูู ุนูุตุฑ ูู ุงููุตูููุฉ ูู **ูุงุฆู (Object)** ูู:
  - `id` ูุฑูุฏ (ูู `uuidv4`)
  - `type`
  - `data`
- ูุณุชุฎุฏู ููุชุจุฉ `@dnd-kit` (ุงููุชูุงููุฉ 100%) ูุนูู **ุงูุณุญุจ ูุงูุฅููุงุช (Drag & Drop)** ุนู ุทุฑูู ุฅุนุงุฏุฉ ุชุฑุชูุจ ูุฐู ุงููุตูููุฉ.
- ูููู `BlockEditor` ูููู ุจุนุฑุถ ุญููู ุงูุฅุฏุฎุงู (`<input>`, `<textarea>`) ุงูููุงุณุจุฉ ููู ููุน ุจููู.
- ูููู `BlockPreview` ูููู ุจุนุฑุถ **ุงููุนุงููุฉ ุงูุญูุฉ**.

### ููุชุทููุฑ ุงููุณุชูุจูู (ุนูุฏ ุฅุถุงูุฉ ุจููู ุฌุฏูุฏ):

1. **ุฃุถู ุงูููุน:** ูู ุฏุงูุฉ `addContentBlock`.
2. **ุฃุถู ุงููุญุฑุฑ:** ุฃุถู `case` ุฌุฏูุฏ ูู `BlockEditor`.
3. **ุฃุถู ุงูุนุงุฑุถ:** ุฃุถู `case` ุฌุฏูุฏ ูู `BlockPreview` (ูู ููู ุงูุฅุถุงูุฉ ูููู ุงูุชุนุฏูู).
4. **(ุงูุฃูู):** ูู ุจุชุญุฏูุซ `BlockRenderer` ูู ุตูุญุฉ ุงููุงุฌูุฉ ุงูุฃูุงููุฉ (`/materials/[slug]/page.js`) ููููู ูุฐุง ุงูุจููู ุงูุฌุฏูุฏ.

---

## 4. ุงูุจุญุซ (Algolia) - (ุชู ุฅูุบุงุคู)

> **ููุงุญุธุฉ ูุงูุฉ:**  
> ููุฏ ูุงุฌููุง ูุดุงูู ุชูุงูู ูุชุนููุฏ ูุงุฆูุฉ ุนูุฏ ูุญุงููุฉ ุฏูุฌ **Algolia** ูุน ุจููุฉ ESM/CJS ุงููุฎุชูุทุฉ.

### ุงููุถุน ุงูุญุงูู:

- ุชู ุฅูุบุงุก ูููุฉ ุงูุจุญุซ ุจุงููุต ุงููุงูู (**Full-Text Search**) ุจุงุณุชุฎุฏุงู **Algolia**.
- ุงูุจุญุซ ุงูุญุงูู ูู `/hub` ูู **"ููุชุฑ" ุจุณูุท** ูุจุญุซ ูู ุงูุจูุงูุงุช ุงูุชู ุชู ุฌูุจูุง ูุณุจููุง (ุฃุณูุงุก ุงูููุงุฏุ ุงูุนูุงูููุ ุงููุณูู) ููู ูุนูู ุจุดูู ุฌูุฏ ููุณุชูุฑ.
- **ูุง ุชูู ุจูุญุงููุฉ ุฅุนุงุฏุฉ ุฏูุฌ Algolia** ูุจู ูุฑุงุฌุนุฉ ุดุงููุฉ ูุชูุงูู ุงูุฅุตุฏุงุฑุงุช.

---

## 5. ุงูุจุฑููุจุช ููุฐูุงุก ุงูุงุตุทูุงุนู (AI Agent Prompt)

ุนูุฏ ุจุฏุก ุงูุนููุ ูู ุจูุณุฎ ููุตู ูุฐุง ุงูุจุฑููุจุช ููู AI:

```text
ุฃูุช ูุณุงุนุฏ ุฎุจูุฑ ูู Next.js 15+ (App Router) ู Firebase v12. ุณุชุนูู ุนูู ูุดุฑูุน KawnHub ุงูุฐู ูุณุชุฎุฏู ุจููุฉ Server/Client Components ุจุดูู ุตุงุฑู.

ุงูููุงุนุฏ ุงูุฐูุจูุฉ:
- ููููุน ุงุณุชูุฑุงุฏ db ุฃู auth ูู firebase/firestore ุฃู firebase/auth ูู ุฃู ููู ูุญุชูู ุนูู 'use client'. ูุฐุง ูู ุงูุฎุทุฃ ุงูุฃูู ูุงูุฃูู.
- ุฌูุจ ุงูุจูุงูุงุช ูุชู ุญุตุฑููุง ูู ููููุงุช ุงูุฎุงุฏู (ูุซู page.js ุฃู layout.js ุจุฏูู 'use client').
- ุงูุจูุงูุงุช ุชูุฑุฑ ูู props ุฅูู ููููุงุช ุงูุนููู.
- ุงูุจูุงูุงุช ุงููุนูุฏุฉ (ูุซู Timestamp) ูุฌุจ ุชุญููููุง (Serialization) ูู ูููู ุงูุฎุงุฏู ูุจู ุชูุฑูุฑูุง (ุงุณุชุฎุฏู .toDate().toISOString()).
- ููุญุฉ ุงูุชุญูู (/admin/topics) ุชุณุชุฎุฏู ูุธุงู "ุจูููุงุช" ูุฎุตุต ูุจูู ุนูู ูุตูููุฉ (Array) ููุณุชุฎุฏู @dnd-kit ููุณุญุจ ูุงูุฅููุงุช. ูุญู ูุง ูุณุชุฎุฏู react-quill ุฃู TipTap ุฃู Lexical ุจุณุจุจ ูุดุงูู ุงูุชูุงูู.
- ุงูุฃูุงู ูุชู ุนุจุฑ AuthContext ุงูุฐู ูุคูู ูุฌูุฏ /adminุ ููุนุชูุฏ ุนูู "ูุงุฆูุฉ ุจูุถุงุก" ูู ูุฌููุนุฉ admins ูู Firestore.
- ุชูููู ุงูุฃููุงุฏ ูุชู ุจุงุณุชุฎุฏุงู react-syntax-highlighter.